/*!
 * annex v0.1.0-dev
 */
/*!
 * Module Interaction
 */
const MODULE_NAME="Interaction";import{assert,isA,orDefault,hasValue}from"./basic.js";import{findTextNodes}from"./elements.js";import{applyStyles}from"./css.js";const NOT_AN_HTMLELEMENT_ERROR="given node/target is not an HTMLElement";export function createSelection(e,t=0,n=0){let l,s,o,a;if(t=orDefault(t,0,"int"),n=orDefault(n,0,"int"),assert(isA(e,"htmlelement"),`${MODULE_NAME}:createSelection | ${NOT_AN_HTMLELEMENT_ERROR}`),hasValue(e.selectionStart,e.selectionEnd))e.focus(),e.select(),a=e.value,e.selectionStart=t,e.selectionEnd=a.length-n,l=a.substring(e.selectionStart,e.selectionEnd);else if(isA(window.getSelection,"function")){if(s=document.createRange(),s.selectNodeContents(e),hasValue(t)||hasValue(n)){const l=findTextNodes(e);if(l.length>0){let e=0,o=l[e],a=l.length-1,r=l[a];if(hasValue(t)){let n=t,a=n<=o.length;for(;!a&&hasValue(o);)e++,hasValue(l[e])?(n-=o.length,o=l[e],a=n<=o.length):(n=o.length,a=!0);s.setStart(o,n)}if(hasValue(n)){let e=n,t=e<=r.length;for(;!t&&hasValue(r);)a--,hasValue(l[a])?(e-=r.length,r=l[a],t=e<=r.length):(e=r.length,t=!0);s.setEnd(r,r.length-e)}}}o=window.getSelection(),o.removeAllRanges(),o.addRange(s),l=s.toString()}else isA(document.body.createTextRange,"function")&&(s=document.body.createTextRange(),s.moveToElementText(e),hasValue(t)&&s.moveStart("character",t),hasValue(n)&&s.moveEnd("character",-n),s.select(),l=s.text);return l}export function removeSelections(){isA(window.getSelection,"function")?window.getSelection().removeAllRanges():isA(document.getSelection,"function")&&document.getSelection().removeAllRanges(),hasValue(document.selection)&&document.selection.empty()}export function disableSelection(e){return assert(isA(e,"htmlelement"),`${MODULE_NAME}:disableSelection | ${NOT_AN_HTMLELEMENT_ERROR}`),e.onselectstart=()=>!1,e.unselectable="on",applyStyles(e,{"user-select":"none"},!0),applyStyles(e,{"-webkit-touch-callout":"none"}),e}export function enableSelection(e){return assert(isA(e,"htmlelement"),`${MODULE_NAME}:disableSelection | ${NOT_AN_HTMLELEMENT_ERROR}`),e.onselectstart=void 0,e.unselectable="off",applyStyles(e,{"user-select":null},!0),applyStyles(e,{"-webkit-touch-callout":null}),e}export function obfuscatePrivateMailToLink(e,t=!1,n="",l="",s="",o="",a="",r="",i="",c=""){t=orDefault(t,!1,"bool"),o=orDefault(o,"","str"),a=orDefault(a,"","str"),s=orDefault(s,"","str"),l=orDefault(l,"","str"),n=orDefault(n,"","str"),c=orDefault(c,"","str"),i=orDefault(i,"","str"),r=orDefault(r,"","str"),assert(""!==s&&""!==l,`${MODULE_NAME}:obfuscatePrivateMailToLink | basic mail parts missing`),""!==n&&(n=`.${n}`),""!==r&&(r=`.${r}`);let u=new URLSearchParams;""!==o&&u.set("subject",o),""!==a&&u.set("body",a),""!==c&&""!==i&&u.set("cc",`${c}@${i}${r}`),u=u.toString(),""!==u&&(u=`?${u.replaceAll("+","%20")}`);let f=0;const d=()=>{f++,e.setAttribute("href",`mailto:${s}@${l}${n}${u}`)};e.addEventListener("mouseenter",d),e.addEventListener("focusin",d);const E=()=>{f--,f<=0&&e.setAttribute("href","")};return e.addEventListener("mouseleave",E),e.addEventListener("focusout",E),t&&(e.innerHTML=`${s}@${l}${n}`.replace(/(\w{1})/g,"$1&zwnj;")),e}export function obfuscatePrivateTelLink(e,t=!1,n="",l="",s="",o=""){t=orDefault(t,!1,"bool"),n=orDefault(n,"","str").replace(/[^0-9\-]/g,""),l=orDefault(l,"","str").replace(/[^0-9\-]/g,""),s=orDefault(s,"","str").replace(/[^0-9]/g,""),o=orDefault(o,"","str").replace(/[^0-9]/g,""),assert(""!==l||""!==n,`${MODULE_NAME}:obfuscatePrivateTelLink | basic tel parts missing`);let a=0;const r=()=>{a++,e.setAttribute("href",`tel:+${o}${s}${l.replace(/-/g,"")}${n.replace(/-/g,"")}`)};e.addEventListener("mouseenter",r),e.addEventListener("focusin",r);const i=()=>{a--,a<=0&&e.setAttribute("href","")};e.addEventListener("mouseleave",i),e.addEventListener("focusout",i),t&&(e.innerHTML=`+${o} ${s} ${l}${n}`.replace(/(\w{1})/g,"$1&zwnj;"))}
//# sourceMappingURL=interaction.js.map
