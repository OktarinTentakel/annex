{"version":3,"file":"interaction.js","names":["MODULE_NAME","assert","isA","orDefault","hasValue","findTextNodes","applyStyles","NOT_AN_HTMLELEMENT_ERROR","createSelection","node","startOffset","endOffset","selectionText","range","selection","rangeText","selectionStart","selectionEnd","focus","select","value","length","substring","window","getSelection","document","createRange","selectNodeContents","textNodes","startNodeIndex","startNode","endNodeIndex","endNode","remainingStartOffset","startOffsetNodeFound","setStart","remainingEndOffset","endOffsetNodeFound","setEnd","removeAllRanges","addRange","toString","body","createTextRange","moveToElementText","moveStart","moveEnd","text","removeSelections","empty","disableSelection","onselectstart","unselectable","enableSelection","undefined","obfuscatePrivateMailToLink","link","setAsContent","tld","afterAtWithoutTld","beforeAt","subject","ccTld","ccAfterAtWithoutTld","ccBeforeAt","optionParams","URLSearchParams","set","replaceAll","interactionCount","fAddLinkUrl","setAttribute","addEventListener","fRemoveLinkUrl","innerHTML","replace","obfuscatePrivateTelLink","secondTelPart","firstTelPart","regionPart","countryPart"],"sources":["interaction.js"],"mappings":"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","sourcesContent":["/*!\n * Module Interaction\n */\n\n/**\n * @namespace Interaction\n */\n\nconst MODULE_NAME = 'Interaction';\n\n\n\n//###[ IMPORTS ]########################################################################################################\n\nimport {assert, isA, orDefault, hasValue} from './basic.js';\nimport {findTextNodes} from './elements.js';\nimport {applyStyles} from './css.js';\n\n\n\n//###[ DATA ]###########################################################################################################\n\nconst NOT_AN_HTMLELEMENT_ERROR = 'given node/target is not an HTMLElement';\n\n\n\n//###[ EXPORTS ]########################################################################################################\n\n/**\n * @namespace Interaction:createSelection\n */\n\n/**\n * Programmatically create a text selection inside a node, possibly reaching across several child nodes,\n * but virtually only working with the raw text content. Can also be used to create a selection in text\n * inputs for example.\n *\n * Be aware that the endOffset is neither the length to select nor the last index, but the offset starting\n * from the last character in the node counting backwards (like a reverse startOffset). The reason for this wonkyness\n * is the fact that we have to implement three different ways of creating selections in this function, this\n * notation being the most compatible one. We assume the default use case for this method is to select all content\n * of a node with the possibility to skip one or two unwanted characters on each side of the content.\n *\n * Hint: You cannot create a selection spanning normal inline text into an input, ending there. To create a selection in\n * a text input, please target that element specifically or make sure the selection spans the whole input.\n * Furthermore, on mobile/iOS devices creation of selection ranges might only be possible in text inputs.\n *\n * @param  {HTMLElement} node - the element to create a selection inside\n * @param  {?Number} [startOffset=0] - characters to leave out at the beginning of the text content\n * @param  {?Number} [endOffset=0] - characters to leave out at the end of the text content\n * @return {String} the selected text\n *\n * @memberof Interaction:createSelection\n * @alias createSelection\n * @see removeSelections\n * @example\n * const selectedText = createSelection(copytextElement, 12, 6);\n */\nexport function createSelection(node, startOffset=0, endOffset=0){\n\tconst __methodName__ = 'createSelection';\n\n\tstartOffset = orDefault(startOffset, 0, 'int');\n\tendOffset = orDefault(endOffset, 0, 'int');\n\n\tassert(isA(node, 'htmlelement'), `${MODULE_NAME}:${__methodName__} | ${NOT_AN_HTMLELEMENT_ERROR}`);\n\n\tlet\tselectionText, range, selection, rangeText;\n\n\tif( hasValue(node.selectionStart, node.selectionEnd) ){\n\t\tnode.focus();\n\t\tnode.select();\n\t\trangeText = node.value;\n\t\tnode.selectionStart = startOffset;\n\t\tnode.selectionEnd = rangeText.length - endOffset;\n\t\tselectionText = rangeText.substring(node.selectionStart, node.selectionEnd);\n\t} else if( isA(window.getSelection, 'function') ){\n\t\trange = document.createRange();\n\t\trange.selectNodeContents(node);\n\n\t\tif( hasValue(startOffset) || hasValue(endOffset) ){\n\t\t\tconst textNodes = findTextNodes(node);\n\t\t\tif( textNodes.length > 0 ){\n\t\t\t\tlet\n\t\t\t\t\tstartNodeIndex = 0,\n\t\t\t\t\tstartNode = textNodes[startNodeIndex],\n\t\t\t\t\tendNodeIndex = textNodes.length - 1,\n\t\t\t\t\tendNode = textNodes[endNodeIndex]\n\t\t\t\t;\n\n\t\t\t\tif( hasValue(startOffset) ){\n\t\t\t\t\tlet\n\t\t\t\t\t\tremainingStartOffset = startOffset,\n\t\t\t\t\t\tstartOffsetNodeFound = (remainingStartOffset <= startNode.length)\n\t\t\t\t\t;\n\n\t\t\t\t\twhile( !startOffsetNodeFound && hasValue(startNode) ){\n\t\t\t\t\t\tstartNodeIndex++;\n\t\t\t\t\t\tif( hasValue(textNodes[startNodeIndex]) ){\n\t\t\t\t\t\t\tremainingStartOffset -= startNode.length;\n\t\t\t\t\t\t\tstartNode = textNodes[startNodeIndex];\n\t\t\t\t\t\t\tstartOffsetNodeFound = (remainingStartOffset <= startNode.length);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tremainingStartOffset = startNode.length;\n\t\t\t\t\t\t\tstartOffsetNodeFound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trange.setStart(startNode, remainingStartOffset);\n\t\t\t\t}\n\n\t\t\t\tif( hasValue(endOffset) ){\n\t\t\t\t\tlet\n\t\t\t\t\t\tremainingEndOffset = endOffset,\n\t\t\t\t\t\tendOffsetNodeFound = (remainingEndOffset <= endNode.length)\n\t\t\t\t\t;\n\n\t\t\t\t\twhile( !endOffsetNodeFound && hasValue(endNode) ){\n\t\t\t\t\t\tendNodeIndex--;\n\t\t\t\t\t\tif( hasValue(textNodes[endNodeIndex]) ){\n\t\t\t\t\t\t\tremainingEndOffset -= endNode.length;\n\t\t\t\t\t\t\tendNode = textNodes[endNodeIndex];\n\t\t\t\t\t\t\tendOffsetNodeFound = (remainingEndOffset <= endNode.length);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tremainingEndOffset = endNode.length;\n\t\t\t\t\t\t\tendOffsetNodeFound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trange.setEnd(endNode, endNode.length - remainingEndOffset);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tselection = window.getSelection();\n\t\tselection.removeAllRanges();\n\t\tselection.addRange(range);\n\t\tselectionText = range.toString();\n\t} else if( isA(document.body.createTextRange, 'function') ){\n\t\trange = document.body.createTextRange();\n\t\trange.moveToElementText(node);\n\n\t\tif( hasValue(startOffset) ){\n\t\t\trange.moveStart('character', startOffset);\n\t\t}\n\n\t\tif( hasValue(endOffset) ){\n\t\t\trange.moveEnd('character', -endOffset);\n\t\t}\n\n\t\trange.select();\n\n\t\tselectionText = range.text;\n\t}\n\n\treturn selectionText;\n}\n\n\n\n/**\n * @namespace Interaction:removeSelections\n */\n\n/**\n * Removes all text selections from the current window if possible.\n * Certain mobile devices like iOS devices might block this behaviour actively.\n *\n * @memberof Interaction:removeSelections\n * @alias removeSelections\n * @see createSelection\n * @example\n * removeSelections();\n */\nexport function removeSelections(){\n\tif( isA(window.getSelection, 'function') ){\n\t\twindow.getSelection().removeAllRanges();\n\t} else if( isA(document.getSelection, 'function') ){\n\t\tdocument.getSelection().removeAllRanges();\n\t}\n\n\tif( hasValue(document.selection) ){\n\t\tdocument.selection.empty();\n\t}\n}\n\n\n\n/**\n * @namespace Interaction:disableSelection\n */\n\n/**\n * Disables the possibility to create a selection in an element.\n *\n * @param  {HTMLElement} node - the element to disable user selection for\n * @return {HTMLElement} the node with disabled selection\n *\n * @memberof Interaction:disableSelection\n * @alias disableSelection\n * @see enableSelection\n * @example\n * disableSelection(widget);\n */\nexport function disableSelection(node){\n\tconst __methodName__ = 'disableSelection';\n\n\tassert(isA(node, 'htmlelement'), `${MODULE_NAME}:${__methodName__} | ${NOT_AN_HTMLELEMENT_ERROR}`);\n\n\tnode.onselectstart = () => false;\n\tnode.unselectable = 'on';\n\tapplyStyles(node, {'user-select' : 'none'}, true);\n\tapplyStyles(node, {'-webkit-touch-callout' : 'none'});\n\n\treturn node;\n}\n\n\n\n/**\n * @namespace Interaction:enableSelection\n */\n\n/**\n * (Re)enables the possibility to create a selection in an element. Most likely after having been disabled\n * using `disableSelection`.\n *\n * @param  {HTMLElement} node - the element to (re)enable user selection for\n * @return {HTMLElement} the node with (re)enabled selection\n *\n * @memberof Interaction:enableSelection\n * @alias enableSelection\n * @see disableSelection\n * @example\n * enableSelection(widget);\n */\nexport function enableSelection(node){\n\tconst __methodName__ = 'disableSelection';\n\n\tassert(isA(node, 'htmlelement'), `${MODULE_NAME}:${__methodName__} | ${NOT_AN_HTMLELEMENT_ERROR}`);\n\n\tnode.onselectstart = undefined;\n\tnode.unselectable = 'off';\n\tapplyStyles(node, {'user-select' : null}, true);\n\tapplyStyles(node, {'-webkit-touch-callout' : null});\n\n\treturn node;\n}\n\n\n\n/**\n * @namespace Interaction:obfuscatePrivateMailToLink\n */\n\n/**\n * Augment a link element to hold an obfuscated private mailto link, to be able to contact people\n * via their own mail address, without the need to openly write the address into the DOM permanently,\n * in a way crawlers could identify easily.\n *\n * The method takes all parts of the address as (hopefully) unidentifiable parameters and then applies them internally,\n * to build an email string with mailto protocol dynamically on mouse or focus interaction in the link's href,\n * offering normal link functionality from here on. If the interaction ends, the href is removed again immediately,\n * so the link is only and exclusively readable and complete during user interaction.\n *\n * You may set the link text yourself or set `setAsContent` to true, to let the function fill the link text with\n * the completed address. Be aware, that this, although still being obfuscated, lowers the level of security for this\n * solution.\n *\n * Although most parameters are technically optional, this function still expects `beforeAt` and `afterAtWithoutTld` to\n * be filled. While these parts are strictly necessary here: I'd always suggest to use all parts, since, the more\n * of an address is written together, the easier the address can be parsed.\n *\n * @param {HTMLElement} link - the link to augment, has to be a node where we can set a \"href\" attribute\n * @param {?Boolean} [setAsContent=false] - define if the address should be used as link text (still uses string obfuscation, but weaker against bot with JS execution)\n * @param {?String} [tld=''] - the top level domain to use\n * @param {?String} [afterAtWithoutTld=''] - the address part after the @ but before the tld\n * @param {?String} [beforeAt=''] - the address part before the @\n * @param {?String} [subject=''] - the subject the mail should have, if you want to preset this\n * @param {?String} [body=''] - the body text the mail should have initially, if you want to preset this\n * @param {?String} [ccTld=''] - the top level domain to use for the cc address\n * @param {?String} [ccAfterAtWithoutTld=''] - the address part after the @ but before the tld for the cc address\n * @param {?String} [ccBeforeAt=''] - the address part before the @ for the cc address\n * @throws error if beforeAt or afterAtWithoutTld are empty\n * @return {HTMLElement} the augmented link\n *\n * @memberof Interaction:obfuscatePrivateMailToLink\n * @alias obfuscatePrivateMailToLink\n * @example\n * obfuscatePrivateMailToLink(document.querySelector('a'), true, 'de', 'gmail', 'recipient', 'Hello there!', 'How are you these days?');\n */\nexport function obfuscatePrivateMailToLink(\n\tlink,\n\tsetAsContent=false,\n\ttld='',\n\tafterAtWithoutTld='',\n\tbeforeAt='',\n\tsubject='',\n\tbody='',\n\tccTld='',\n\tccAfterAtWithoutTld='',\n\tccBeforeAt=''\n){\n\tconst __methodName__ = 'obfuscatePrivateMailToLink';\n\n\tsetAsContent = orDefault(setAsContent, false, 'bool');\n\tsubject = orDefault(subject, '', 'str');\n\tbody = orDefault(body, '', 'str');\n\tbeforeAt = orDefault(beforeAt, '', 'str');\n\tafterAtWithoutTld = orDefault(afterAtWithoutTld, '', 'str');\n\ttld = orDefault(tld, '', 'str');\n\tccBeforeAt = orDefault(ccBeforeAt, '', 'str');\n\tccAfterAtWithoutTld = orDefault(ccAfterAtWithoutTld, '', 'str');\n\tccTld = orDefault(ccTld, '', 'str');\n\n\tassert((beforeAt !== '') && (afterAtWithoutTld !== ''), `${MODULE_NAME}:${__methodName__} | basic mail parts missing`);\n\n\tif( tld !== '' ){\n\t\ttld = `.${tld}`;\n\t}\n\n\tif( ccTld !== '' ){\n\t\tccTld = `.${ccTld}`;\n\t}\n\n\tlet optionParams = new URLSearchParams();\n\tif( subject !== '' ){\n\t\toptionParams.set('subject', subject);\n\t}\n\tif( body !== '' ){\n\t\toptionParams.set('body', body);\n\t}\n\tif( (ccBeforeAt !== '') && (ccAfterAtWithoutTld !== '') ){\n\t\toptionParams.set('cc', `${ccBeforeAt}@${ccAfterAtWithoutTld}${ccTld}`);\n\t}\n\toptionParams = optionParams.toString();\n\tif( optionParams !== '' ){\n\t\toptionParams = `?${optionParams.replaceAll('+', '%20')}`;\n\t}\n\n\tlet interactionCount = 0;\n\tconst fAddLinkUrl = () => {\n\t\tinteractionCount++;\n\t\tlink.setAttribute('href', `mailto:${beforeAt}@${afterAtWithoutTld}${tld}${optionParams}`);\n\t};\n\tlink.addEventListener('mouseenter', fAddLinkUrl);\n\tlink.addEventListener('focusin', fAddLinkUrl);\n\tconst fRemoveLinkUrl = () => {\n\t\tinteractionCount--;\n\t\tif( interactionCount <= 0 ){\n\t\t\tlink.setAttribute('href', '');\n\t\t}\n\t};\n\tlink.addEventListener('mouseleave', fRemoveLinkUrl);\n\tlink.addEventListener('focusout', fRemoveLinkUrl);\n\n\tif( setAsContent ){\n\t\tlink.innerHTML = (`${beforeAt}@${afterAtWithoutTld}${tld}`).replace(/(\\w{1})/g, '$1&zwnj;');\n\t}\n\n\treturn link;\n}\n\n\n\n/**\n * @namespace Interaction:obfuscatePrivateTelLink\n */\n\n/**\n * Augment a link element to hold an obfuscated private tel link, to be able to contact people\n * via their own phone number, without the need to openly write the number into the DOM permanently,\n * in a way crawlers could identify easily.\n *\n * The method takes all parts of the number as (hopefully) unidentifiable parameters and then applies them internally,\n * to build a number string with tel protocol dynamically on mouse or focus interaction in the link's href,\n * offering normal link functionality from here on. If the interaction ends, the href is removed again immediately,\n * so the link is only and exclusively readable and complete during user interaction.\n *\n * You may set the link text yourself or set `setAsContent` to true, to let the function fill the link text with\n * the completed address. Be aware, that this, although still being obfuscated, lowers the level of security for this\n * solution.\n *\n * Although most parameters are technically optional, this function still expects `secondTelPart` or `firstTelPart` to\n * be filled. While only one part is strictly necessary here: I'd always suggest to use all parts, since, the more\n * of a number is written together, the easier the number can be parsed.\n *\n * @param {HTMLElement} link - the link to augment, has to be a node where we can set a \"href\" attribute\n * @param {?Boolean} [setAsContent=false] - define if the number should be used as link text, being formatted according to DIN 5008 (still uses string obfuscation, but weaker against bot with JS execution)\n * @param {?Number|String} [secondTelPart=''] - second half of the main number +49 04 123(4-56)<-this; add a dash to signify where a base number ends and the personal part starts\n * @param {?Number|String} [firstTelPart=''] - first half of the main number +49 04 (123)<-this 4-56\n * @param {?Number|String} [regionPart=''] - the local part of the number after the country part e.g. +49(04)<-this 1234-56\n * @param {?Number|String} [countryPart=''] - the country identifier with or without + this->(+49) 04 1234-56 (do not prefix with a local 0!)\n * @throws error if `secondTelPart` and `firstTelPart` are empty\n * @return {HTMLElement} the augmented link\n *\n * @memberof Interaction:obfuscatePrivateTelLink\n * @alias obfuscatePrivateTelLink\n * @example\n * obfuscatePrivateTelLink(document.querySelector('a'), true, 123, 439, 40, '+49');\n */\nexport function obfuscatePrivateTelLink(\n\tlink,\n\tsetAsContent=false,\n\tsecondTelPart='',\n\tfirstTelPart='',\n\tregionPart='',\n\tcountryPart=''\n){\n\tconst __methodName__ = 'obfuscatePrivateTelLink';\n\n\tsetAsContent = orDefault(setAsContent, false, 'bool');\n\tsecondTelPart = orDefault(secondTelPart, '', 'str').replace(/[^0-9\\-]/g, '');\n\tfirstTelPart = orDefault(firstTelPart, '', 'str').replace(/[^0-9\\-]/g, '');\n\tregionPart = orDefault(regionPart, '', 'str').replace(/[^0-9]/g, '');\n\tcountryPart = orDefault(countryPart, '', 'str').replace(/[^0-9]/g, '');\n\n\tassert((firstTelPart !== '') || (secondTelPart !== ''), `${MODULE_NAME}:${__methodName__} | basic tel parts missing`);\n\n\tlet interactionCount = 0;\n\tconst fAddLinkUrl = () => {\n\t\tinteractionCount++;\n\t\tlink.setAttribute('href', `tel:+${countryPart}${regionPart}${firstTelPart.replace(/-/g, '')}${secondTelPart.replace(/-/g, '')}`);\n\t};\n\tlink.addEventListener('mouseenter', fAddLinkUrl);\n\tlink.addEventListener('focusin', fAddLinkUrl);\n\tconst fRemoveLinkUrl = () => {\n\t\tinteractionCount--;\n\t\tif( interactionCount <= 0 ){\n\t\t\tlink.setAttribute('href', '');\n\t\t}\n\t};\n\tlink.addEventListener('mouseleave', fRemoveLinkUrl);\n\tlink.addEventListener('focusout', fRemoveLinkUrl);\n\n\tif( setAsContent ){\n\t\tlink.innerHTML = (`+${countryPart} ${regionPart} ${firstTelPart}${secondTelPart}`).replace(/(\\w{1})/g, '$1&zwnj;');\n\t}\n}\n"]}