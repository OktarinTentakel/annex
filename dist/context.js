/*!
 * annex v0.1.0-dev
 */
/*!
 * Module Context
 */
const MODULE_NAME="Context";import{hasValue,isA,orDefault,Observable}from"./basic.js";import{throttle}from"./functions.js";import{createNode}from"./elements.js";import{reschedule}from"./timers.js";const INTERACTION_TYPE_DETECTION={touchHappening:!1,touchEndingTimer:null,touchStartHandler(){INTERACTION_TYPE_DETECTION.touchHappening=!0,"touch"!==CURRENT_INTERACTION_TYPE.getValue()&&CURRENT_INTERACTION_TYPE.setValue("touch")},touchEndHandler(){INTERACTION_TYPE_DETECTION.touchEndingTimer=reschedule(INTERACTION_TYPE_DETECTION.touchEndingTimer,1032,(()=>{INTERACTION_TYPE_DETECTION.touchHappening=!1}))},blurHandler(){INTERACTION_TYPE_DETECTION.touchEndingTimer=reschedule(INTERACTION_TYPE_DETECTION.touchEndingTimer,1032,(()=>{INTERACTION_TYPE_DETECTION.touchHappening=!1}))},mouseMoveHandler:throttle(1e3,(function(){CURRENT_INTERACTION_TYPE.getValue("pointer")&&!INTERACTION_TYPE_DETECTION.touchHappening&&CURRENT_INTERACTION_TYPE.setValue("pointer")}))};export let CURRENT_INTERACTION_TYPE;export function browserSupportsHistoryManipulation(){return hasValue(window.history)&&isA(window.history.pushState,"function")&&isA(window.history.replaceState,"function")}export function contextHasHighDpi(){return!!window.matchMedia&&window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.5),only screen and (-o-min-device-pixel-ratio: 3/2),only screen and (min--moz-device-pixel-ratio: 1.5),only screen and (min-device-pixel-ratio: 1.5),only screen and (min-resolution: 144dpi),only screen and (min-resolution: 1.5dppx)").matches}export function browserScrollbarWidth(){const e=createNode("div");e.style.visibility="hidden",e.style.opacity="0",e.style.pointerEvents="none",e.style.overflow="scroll",e.style.position="fixed",e.style.top="0",e.style.right="0",e.style.left="0",e.style.height="50px";const t=createNode("div");t.style.width="100%",t.style.height="100px",e.appendChild(t),document.body.appendChild(e);const n=e.offsetWidth-t.offsetWidth;return document.body.removeChild(e),n}export function detectInteractionType(e=!1){return e=orDefault(e,!1,"bool"),hasValue(CURRENT_INTERACTION_TYPE)||(CURRENT_INTERACTION_TYPE=new Observable(""),"ontouchstart"in document&&"ontouchend"in document&&window.navigator.maxTouchPoints>0?CURRENT_INTERACTION_TYPE.setValue("touch"):CURRENT_INTERACTION_TYPE.setValue("pointer"),document.addEventListener("touchstart",INTERACTION_TYPE_DETECTION.touchStartHandler),document.addEventListener("touchend",INTERACTION_TYPE_DETECTION.touchEndHandler),window.addEventListener("blur",INTERACTION_TYPE_DETECTION.blurHandler),document.addEventListener("mousemove",INTERACTION_TYPE_DETECTION.mouseMoveHandler)),e?CURRENT_INTERACTION_TYPE:CURRENT_INTERACTION_TYPE.getValue()}export function detectAppleDevice(e=null){let t=/iPhone|iPad|iPod|Macintosh/.exec(window.navigator.userAgent),n=null;if(Array.isArray(t)&&t.length>0?t=t[0]:(t=/^(iPhone|iPad|iPod|Mac)/.exec(window.navigator.platform),Array.isArray(t)&&t.length>0?(t=t[0],"Mac"===t&&(t="Macintosh")):t=null),hasValue(t)){switch("Macintosh"===t&&window.navigator.maxTouchPoints>1&&(t="iPad"),t){case"iPad":n="ipad";break;case"iPhone":n="iphone";break;case"iPod":n="ipod";break;case"Macintosh":n="mac"}isA(e,"function")&&(n=e(n))}return n}
//# sourceMappingURL=context.js.map
